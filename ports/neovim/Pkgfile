version="0.8.0"
desc='Fork of Vim aiming to improve user experience, plugins, and GUIs'
makedeps=["libuv", "gperf", "cmake"]
deps=["libuv"]
source=[
        {url="https://github.com/neovim/neovim/archive/refs/tags/v$version.tar.gz"},
]

build='''
	cd neovim-${version}

	noname-cmake -Hcmake.deps -B.deps -DUSE_BUNDLED=OFF \
		-DUSE_BUNDLED_UNIBILIUM=ON \
		-DUSE_BUNDLED_LIBVTERM=ON \
		-DUSE_BUNDLED_LIBTERMKEY=ON \
		-DUSE_BUNDLED_MSGPACK=ON \
		-DUSE_BUNDLED_LUAJIT=ON \
		-DUSE_BUNDLED_LUAROCKS=ON \
		-DUSE_BUNDLED_LUV=ON \
		-DUSE_BUNDLED_TS_PARSERS=ON \
		-DUSE_BUNDLED_TS=ON
	cmake --build .deps

	noname-cmake -H. -Bbuild
	cmake --build build
	DESTDIR="${pkgdir}" cmake --build build --target install
	find "$pkgdir/bin" -type f -exec strip {} \;
'''
