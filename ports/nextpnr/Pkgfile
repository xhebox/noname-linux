version="0.1"
desc="Portable FPGA place and route tool"
deps=["boost", "python3", "prjtrellis", "icestorm"]
makedeps=["boost", "python3", "prjtrellis", "icestorm", "eigen"]
source=[{url="https://github.com/YosysHQ/nextpnr/archive/refs/tags/nextpnr-$version.tar.gz"}]

build='''
	cmake nextpnr-nextpnr-$version -Bbuild \
				-DARCH="generic" \
				-DARCH="ice40" \
				-DARCH="ecp5" \
				-DCMAKE_INSTALL_PREFIX= \
				-DCMAKE_INSTALL_LIBDIR=/lib \
				-DCMAKE_INSTALL_DATADIR=/share \
				-DCMAKE_INSTALL_SYSCONFDIR=/etc \
				-DCMAKE_BUILD_TYPE=Release \
				-DBUILD_SHARED_LIBS=ON
	cmake --build build
	DESTDIR="${pkgdir}" cmake --build build --target install
'''
