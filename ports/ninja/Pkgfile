version="1.10.0"
re2c_version="1.1.1"
makedeps=["python3"]
deps=["python3"]
desc="Small build system with a focus on speed"
source=[
	{url="https://github.com/skvadrik/re2c/archive/${re2c_version}.tar.gz"},
	{url="https://github.com/martine/ninja/archive/v${version}.tar.gz"},
]

build='''
	export PATH="$srcdir/bin:$PATH"

	cd re2c-${re2c_version}/re2c
	./autogen.sh
	./configure --prefix=
	make
	make DESTDIR="$srcdir/bin" install
	cd -

	cd ninja-$version
	sed -e "s|subprocess.check_call(rebuild_args)|pass|" -i configure.py
	python configure.py --bootstrap
	python ./configure.py
	install -m755 -D ninja "$pkgdir/bin/ninja"
	install -m644 -D misc/ninja.vim "$pkgdir/share/vim/vimfiles/syntax/ninja.vim"
	install -m644 -D misc/bash-completion "$pkgdir/share/bash-completion/completions/ninja"
	install -m644 -D misc/zsh-completion "$pkgdir/share/zsh/site-functions/_ninja"
'''
