version="1.11.0"
makedeps=["python3", "python3-numpy", "python3-yaml", "python3-typing", "openmp"]
deps=["python3", "python3-numpy", "python3-yaml", "python3-typing", "openmp"]
source=[
	{url="https://github.com/pytorch/pytorch/releases/download/v$version/pytorch-v$version.tar.gz"},
	{url="musl.patch"},
	{url="fix_include_system.patch"},
]
desc="torch for python"

build='''
	cd pytorch-v$version
	patch -Nbp1 -i ../musl.patch
	sed -i 's/isystem/I/g' torch/utils/cpp_extension.py
	export USE_DISTRIBUTED=OFF
	export USE_CUDA=OFF
	export USE_FFMPEG=OFF
	export BUILD_TEST=OFF
	export USE_OPENMP=ON
	export USE_FBGEMM=ON
	python3 setup.py build
	python3 setup.py install \
		--prefix= \
		--root=$pkgdir \
		--optimize=1
'''
